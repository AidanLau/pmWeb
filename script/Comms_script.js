var csdPath = "file://hkairport/Share/PSU/Projects/aProject%20Implementation/Airport%20Systems/3508/10%20Contractor%20Submission%20SQ%20SN/01%20Submission/Drawing%20-%20AS%20CSD/"
var commsData = [
    {
        "Room Name": ["CC 123X",0],  "Room Code": "3SA 026", "Rev": "A", "Submit": "03-Jan-23",  "Reply": "19-Jan-23", "Status": "B",
        "Aconex": ["GECCL/3508/D/13804/", csdPath + "13804 CC123X/"]
    },
    {
        "Room Name": ["CR 95N",0],"Room Code": "3T2 808", "Rev": "B","Submit": "29-Mar-23","Reply": "24-Apr-23","Status": "B",
        "Aconex": ["GECCL/3508/D/13612/", csdPath + "13612 CR95N/"]
    },
    {
        "Room Name": ["CR 123",0],"Room Code": "6T2 013", "Rev": "B","Submit": "10-May-23","Reply": "12-Jun-23","Status": "C",
        "Aconex": ["GECCL/3508/D/17478/", csdPath + "17478 CR123/"]
    },
    {
        "Room Name": ["CC 95B",0],"Room Code": "1T2 069", "Rev": "A","Submit": "13-Mar-23","Reply": "30-Mar-23","Status": "B",
        "Aconex": ["GECCL/3508/D/16175/", csdPath + "16175 CC95B/"]
    },
    {
        "Room Name": ["CR 96N",0],"Room Code": "3T2 355", "Rev": "B","Submit": "14-Jun-23","Reply": "27-Jun-23","Status": "B",
        "Aconex": ["GECCL/3508/D/17449/", csdPath + "17449 CR96N/"]
        
    },
    {
        "Room Name": ["CR 90",1122144393],"Room Code": "1T2 139", "Rev": "B","Submit": "13-Apr-23","Reply": "04-May-23","Status": "C",
        "Aconex": ["GECCL/3508/D/16892/", csdPath + "16892 CR90/"]
        
    },
    {
        "Room Name": ["CT 214",0],"Room Code": "1P 002", "Rev": "B","Submit": "06-Jul-23","Reply": "04-Aug-23","Status": "B",
        "Aconex": ["GECCL/3508/D/16935/", csdPath + "16935 CT214/"]   
    },
    {
        "Room Name": ["CC 123B",0],"Room Code": "5T2 830", "Rev": "B","Submit": "23-Jun-23","Reply": "24-Jul-23","Status": "B",
        "Aconex": ["GECCL/3508/D/16145/", csdPath + "16145 CC123B/"]       
    },
    {
        "Room Name": ["CR 92N", 1122264296],"Room Code": "2T2 003", "Rev": "B","Submit": "31-Jul-23","Reply": "11-Aug-23","Status": "C",
        "Aconex": ["GECCL/3508/D/17489/", csdPath + "17489 CR92N/"]      
    },
    {
        "Room Name": ["CR 124",0],"Room Code": "6T2 084", "Rev": "A","Submit": "12-Jun-23","Reply": "11-Jul-23","Status": "B",
        "Aconex": ["GECCL/3508/D/18441/", csdPath + "18441 CR124/"] 
    },
    {
        "Room Name": ["CR 94N",0],"Room Code": "3T2 874","Rev": "A","Submit": "31-Mar-23","Reply": "21-Apr-23","Status": "B",
        "Aconex": ["GECCL/3508/D/16884/", csdPath + "16884 CR94N/"]
    },
    {
        "Room Name": ["CR 100",0],"Room Code": "6T2 261", "Rev": "B","Submit": "06-Jul-23","Reply": "07-Aug-23","Status": "B",
        "Aconex": ["GECCL/3508/D/17448/", csdPath + "17448 CR100/"]
    },
    {
        "Room Name": ["CT 212",0],"Room Code": "1T2 202", "Rev": "A","Submit": "20-Apr-23", "Reply": "08-May-23","Status": "B",
        "Aconex": ["GECCL/3508/D/16936/", csdPath + "16936 CT212/"]
    },
    {
        "Room Name": ["CT 211",0],"Room Code": "1T2 207", "Rev": "A","Submit": "23-May-23","Reply": "20-Jun-23","Status": "B",
        "Aconex": ["GECCL/3508/D/18064/", csdPath + "18064 CT211/"]
    },
    {
        "Room Name": ["CT 213",1122328528],"Room Code": "1T2 230", "Rev": "B","Submit": "23-May-23","Reply": "19-Jun-23","Status": "B",
        "Aconex": ["GECCL/3508/D/18065/", csdPath + "18065 CT213/"]
    },
    {
        "Room Name": ["CC 95A",1122696736],"Room Code": "1T2 159", "Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["GECCL/3508/D/20779/A",csdPath + "20779 CC95A/"],
    },
    {
        "Room Name": ["CC 96A",0],"Room Code": "1T2 106", "Rev": "A","Submit": "23-Jun-23","Reply": "23-Jul-23","Status": "B",
        "Aconex": ["GECCL/3508/D/18969/", csdPath + "18969 CC96A/"]
    },
    {
        "Room Name": ["CC 96B",1122354753],"Room Code": "1T2 120", "Rev": "B","Submit": "28-Jun-23","Reply": "23-Jul-23","Status": "B",
        "Aconex": ["GECCL/3508/D/18982/", csdPath + "18982 CC96B/"]
    },
    {
        "Room Name": ["CR 125",1122315071],"Room Code": "2T2 172", "Rev": "B","Submit": "11-May-23", "Reply": "07-Jun-23","Status": "B",
        "Aconex": ["GECCL/3508/D/17487/", csdPath + "17487 CR125/"]
    },
    {
        "Room Name": ["CR 126",1122315679],"Room Code": "2T2 105","Rev": "B","Submit": "12-May-23","Reply": "07-Jun-23","Status": "B",
        "Aconex": ["GECCL/3508/D/17488/", csdPath + "17488 CR126/"]
    },
    {
        "Room Name": ["CC 123A",1122831770],"Room Code": "5T2 388", "Rev": "A","Submit": "22-May-23","Reply": "19-Jun-23","Status": "B",
        "Aconex": ["GECCL/3508/D/18060/", csdPath + "18060 CC123A/"]
    },
    {
        "Room Name": ["CR 97N",1122399237],"Room Code": "3T2 422","Rev": "B","Submit": "07-Jun-23","Reply": "05-Jul-23","Status": "C",
        "Aconex": ["GECCL/3508/D/18427/", csdPath + "18427 CR97N/"]
    },
    {
        "Room Name": ["CC 124A",1117135819],"Room Code": "5T2 528","Rev": "A","Submit": "14-Jul-23","Reply": "17 Aug 23","Status": "B",
        "Aconex": ["GECCL/3508/D/19386/", csdPath + "19386 CC124A/"]
    },
    {
        "Room Name": ["CT 232",1122180796],"Room Code": "3T2 205","Rev": "A","Submit": "24-Jul-23","Reply": "10-Aug-23","Status": "B",
        "Aconex": ["GECCL/3508/D/19380/", csdPath + "19380 CT232/"]
    },
    {
        "Room Name": ["CC 124C",1122440512],"Room Code": "6T2 211","Rev": "A","Submit": "08-Jun-23","Reply": "13-Jul-23","Status": "C",
        "Aconex": ["GECCL/3508/D/18433/", csdPath + "18433 CC124C/"]
    },
    {
        "Room Name": ["CC 124D",0],"Room Code": "6T2 193","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CT 231",1122440747],"Room Code": "3T2 204","Rev": "A","Submit": "24-Jul-23","Reply": "14-Aug-23","Status": "C",
        "Aconex": ["GECCL/3508/D/19708/", csdPath + "19708 CT231/"]
    },
    {
        "Room Name": ["CR 121",0],"Room Code": "4T2 014","Rev": "A","Submit": "06-Jul-23","Reply": "04-Aug-23","Status": "B",
        "Aconex": ["GECCL/3508/D/19000/", csdPath + "19000 CR121/"]
    },
    {
        "Room Name": ["CC 123F",1122868770],"Room Code": "7T2 049","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CC 123E",1124222188],"Room Code": "7T2 079","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CC 123G",1124229090],"Room Code": "7T2 019","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""],
    },
    {
        "Room Name": ["CR 122",0],"Room Code": "4T2 046","Rev": "A","Submit": "06-Jul-23","Reply": "04-Aug-23","Status": "C",
        "Aconex": ["GECCL/3508/D/19001/", csdPath + "19001 CR122/"]
    },
    {
        "Room Name": ["CC 124B",0],"Room Code": "5T2 858","Rev": "A","Submit": "06-Jul-23","Reply": "","Status": "",
        "Aconex": ["GECCL/3508/D/19349/", csdPath + "19349 CC124B/"]
    },
    {
        "Room Name": ["CC 123D",1124126426],"Room Code": "6T2 305","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
        
    },
    {
        "Room Name": ["CC 96X",0],"Room Code": "0NA 071","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CC 123I",1122659362],"Room Code": "7T2 409","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["GECCL/3508/D/20497/",csdPath + "20497 CC123I/"]
    },
    {
        "Room Name": ["CC 124I",1122402926],"Room Code": "7T2 259","Rev": "A","Submit": "10-Aug-23","Reply": "","Status": "",
        "Aconex": ["GECCL/3508/D/20067/", csdPath + "20067 CC124I/"]
    },
    {
        "Room Name": ["CR 93N",1122635548],"Room Code": "3T2 178","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["GECCL/3508/D/20763/", csdPath + "20763 CR93N/"]
    },
    {
        "Room Name": ["CR 98N",1124763959],"Room Code": "3T2 173","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CC 124X",1124686711],"Room Code": "1NA 072","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["GECCL/3508/D/25216/", csdPath + "25216 CC124X/"]
    },
    {
        "Room Name": ["CC 124E",0],"Room Code": "7T2 119","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CC 124F",0],"Room Code": "7T2 119","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CC 124G",1124764470],"Room Code": "7T2 176","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CR 91",0],"Room Code": "2P 004","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    },
    {
        "Room Name": ["CC 95X",0],"Room Code": "0SA 056","Rev": "","Submit": "","Reply": "","Status": "",
        "Aconex": ["",""]
    }
];

var userID = 1074413921;

// Tabel Configuration
$.extend($.fn.dataTable.defaults, {
    searching: true,
    ordering: false,
    paging: false,
    info: true,
    dom: 'Bfrtip',
});

// Submission dataTable
$('#commsTable').dataTable({
    "data": commsData,
    "columns": [
        { 
            "data": "Room Name", 
            "render": function (data, type, row, meta) {
                if (type === 'display') {
                    data = '<a target="_blank" href="' + "https:/hk1.aconex.com/Logon?Action=View&ENTITY=MAIL&ID=" + data[1] + "&USERID=" + userID + '">' + data[0] + '</a>';
                }
                return data;
            }
        },
        { "data": "Room Code" },
        {
            "data": "Aconex",
            "render": function (data, type, row, meta) {
                if (type === 'display') {
                    data = '<a target="_blank" href="' + data[1] + '">' + data[0] + '</a>';
                }
                return data;
            }
        },
        { "data": "Rev" },
        { "data": "Submit" },
        { "data": "Reply" },
        { "data": "Status" }
    ]
});

$(document).ready(function() {
    $('#commsTable').DataTable();
});

// Auto update table width
// refresh the table
var tableWidth = 0; var tableWidthCalc;

function calculateTableWidth(tableName) {
    var table = document.getElementById(tableName);
    tableWidthCalc = innerWidth - table.getBoundingClientRect().left - table.getBoundingClientRect().width;
}

// resize table if needed
function resizeTable(tableName) {
    var table = document.getElementById(tableName);
    if (tableWidthCalc < innerWidth) {
        table.style.width = "100%";
    } else if (tableWidthCalc > innerWidth) {
        table.style.width = (tableWidthCalc - innerWidth) + "px";
    }
}
// calculate table width on initial load
calculateTableWidth('commsTable');

// trigger resize event on page load
resizeTable('commsTable');

// calculate table width on window resize event
addEventListener("resize", function (event) {
     console.log("Window resized");
     calculateTableWidth();}, false);
